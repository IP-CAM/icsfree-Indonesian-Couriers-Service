<modification>
  <name>Indonesian Couriers Service (Free)</name>
	<version>1.0</version>
	<link>http://eshopstrarter.com</link>
	<author>opencartplugin</author>
	<code>indonesian_couriers_service_free</code>
  <file path="admin/controller/localisation/country.php">
		<operation error="skip">
			<search><![CDATA[$this->response->setOutput(json_encode($json));]]></search>
			<add position="after" offset="1"><![CDATA[
        //frd
      	public function zone() {
      		$json = array();
      		$this->load->model('localisation/zone');
      		$zone_info = $this->model_localisation_zone->getZone($this->request->get['zone_id']);
      		$json = array();
      		if ($zone_info) {
      			$this->load->model('localisation/district');
      			if (!empty($zone_info['raoprop_id'])) {
      				$json = array(
      					'zone_id'     => $zone_info['country_id'],
      					'name'        => $zone_info['name'],
      					'code'        => $zone_info['code'],
      					'raoprop_id'  => $zone_info['raoprop_id'],
      					'raoprop'     => $this->model_localisation_district->getDistricts($zone_info['raoprop_id']),
      				);

      			}
      		}
      		$this->response->addHeader('Content-Type: application/json');
      		$this->response->setOutput(json_encode($json));
      	}
      	//
        ]]>
      </add>
		</operation>
  </file>
  <file path="admin/controller/sale/order.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district'); //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$data['payment_zone_id'] = $order_info['payment_zone_id'];]]></search>
      <add position="after"><![CDATA[
        $data['payment_district_id'] = $order_info['payment_district_id']; //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$data['shipping_zone_id'] = $order_info['shipping_zone_id'];]]></search>
      <add position="after"><![CDATA[
        $data['shipping_district_id'] = $order_info['shipping_district_id']; //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$data['payment_zone_id'] = '';]]></search>
      <add position="after"><![CDATA[
        $data['payment_district_id'] = ''; //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$data['shipping_zone_id'] = '';]]></search>
      <add position="after"><![CDATA[
        $data['shipping_district_id'] = ''; //frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="admin/language/en-gb/sale/order.php">
    <operation error="skip">
      <search><![CDATA[$_['entry_zone']]]></search>
      <add position="after"><![CDATA[
        $_['entry_district']           = 'District / City'; //frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="admin/language/id-id/sale/order.php">
    <operation error="skip">
      <search><![CDATA[$_['entry_zone']]]></search>
      <add position="after"><![CDATA[
        $_['entry_district']           = 'Kabupaten / Kota'; //frd
      ]]>
      </add>
    </operation>
  </file>

  <file path="admin/model/sale/order.php">
    <operation error="skip">
      <search><![CDATA[$order_query->row['payment_zone'],]]></search>
      <add position="after"><![CDATA[
        'payment_district_id'     => $order_query->row['payment_district_id'], //frd
				'payment_district'        => $order_query->row['payment_district'], //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$order_query->row['shipping_zone'],]]></search>
      <add position="after"><![CDATA[
        'shipping_district_id'    => $order_query->row['shipping_district_id'], //frd
				'shipping_district'       => $order_query->row['shipping_district'],//frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="admin/view/template/sale/order_form.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-payment-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!--frd-->
        <?php if (!empty($payment_zone_id)) {?>
        <option value="<?php echo $payment_zone_id; ?>"></option>
        <?php } ?>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="1"><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
          <!--frd-->
          <div class="form-group required">
            <label class="col-sm-2 control-label" for="input-payment-district"><?php echo $entry_district; ?></label>
            <div class="col-sm-10">
              <select name="district_id" id="input-payment-district" class="form-control">
                <?php if (!empty($payment_district_id)) {?>
                <option value="<?php echo $payment_district_id; ?>"></option>
                <?php } ?>
              </select>
            </div>
          </div>
          <!------>
        ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-shipping-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!--frd-->
        <?php if (!empty($shipping_zone_id)) {?>
        <option value="<?php echo $shipping_zone_id; ?>"></option>
        <?php } ?>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="2"><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="col-sm-2 control-label" for="input-shipping-district"><?php echo $entry_district; ?></label>
          <div class="col-sm-10">
            <select name="district_id" id="input-shipping-district" class="form-control">
            </select>
          </div>
        </div>
        <!------>
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="1"><![CDATA[<script type="text/javascript">]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('#tab-payment select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
            url: 'index.php?route=localisation/country/zone&token=<?php echo $token; ?>&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        		},
        		complete: function() {
        			$('#tab-payment .fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $payment_district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				//html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
        			}

        			$('#tab-payment select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}

        	});
        });

        $('#tab-payment select[name=\'zone_id\']').trigger('change');

        //--></script>

        <!--frd-->
        <script type="text/javascript"><!--
        $('#tab-shipping select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
            url: 'index.php?route=localisation/country/zone&token=<?php echo $token; ?>&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        		},
        		complete: function() {
        			$('#tab-shipping .fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $shipping_district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				//html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
        			}

        			$('#tab-shipping select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}

        	});
        });

        $('#tab-shipping select[name=\'zone_id\']').trigger('change');

        //--></script>
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/account/address.php">
    <operation error="skip">
      <search><![CDATA[$this->session->data['shipping_address'] = $this->model_account_address->getAddress($this->request->get['address_id']);]]></search>
      <add position="after"><![CDATA[
        //frd
				$this->load->model('localisation/district');
				$district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
				if (isset($district['rajaongkir']['results']['city_name'])){
					$this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
				} else {
					$this->session->data['shipping_address']['district'] = '';
				}
				//---
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($this->request->get['address_id']);]]></search>
      <add position="after"><![CDATA[
        //frd
				$this->load->model('localisation/district');
				$district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
				if (isset($district['rajaongkir']['results']['city_name'])){
					$this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
				} else {
					$this->session->data['payment_address']['district'] = '';
				}
				//---
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district');//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[if (isset($this->error['custom_field'])) {]]></search>
      <add position="before"><![CDATA[
        //frd
    		if (isset($this->error['district'])) {
    			$data['error_district'] = $this->error['district'];
    		} else {
    			$data['error_district'] = '';
    		}
    		//-----

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="0"><![CDATA[$this->load->model('localisation/country');]]></search>
      <add position="before"><![CDATA[
        //frd
    		if (isset($this->request->post['district_id'])) {
    			$data['district_id'] = (int)$this->request->post['district_id'];
    		}  elseif (!empty($address_info)) {
    			$data['district_id'] = $address_info['district_id'];
    		} else {
    			$data['district_id'] = '';
    		}
    		//------
      ]]>
      </add>
    </operation>
  </file>

  <file path="catalog/controller/account/account.php">
    <operation error="skip">
      <search><![CDATA[$this->response->setOutput(json_encode($json));]]></search>
      <add position="after" offset="1"><![CDATA[
        //frd
        public function zone() {
          $json = array();

          $this->load->model('localisation/zone');
          $zone_info = $this->model_localisation_zone->getZone($this->request->get['zone_id']);
          $json = array();
          if ($zone_info) {
            $this->load->model('localisation/district');
            if (!empty($zone_info['raoprop_id'])) {
              $json = array(
                'zone_id'        => $zone_info['country_id'],
                'name'              => $zone_info['name'],
                'code'        => $zone_info['code'],
                'raoprop_id'        => $zone_info['raoprop_id'],
                'raoprop'              => $this->model_localisation_district->getDistricts($zone_info['raoprop_id']),
              );

            }
          }

          $this->response->addHeader('Content-Type: application/json');
          $this->response->setOutput(json_encode($json));
        }
        //
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/account/register.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district');//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[if (isset($this->error['custom_field'])) {]]></search>
      <add position="before"><![CDATA[
        //frd
    		if (isset($this->error['district'])) {
    			$data['error_district'] = $this->error['district'];
    		} else {
    			$data['error_district'] = '';
    		}
    		//-----
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="0"><![CDATA[$this->load->model('localisation/country');]]></search>
      <add position="after"><![CDATA[
        //frd
    		if (isset($this->request->post['district_id'])) {
    			$data['district_id'] = (int)$this->request->post['district_id'];
    		} elseif (isset($this->session->data['shipping_address']['district_id'])) {
    			$data['district_id'] = $this->session->data['shipping_address']['district_id'];
    		} else {
    			$data['district_id'] = '';
    		}
    		//------
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/account/login.php">
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
      <add position="after"><![CDATA[
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['payment_address']['district'] = '';
        }
        //---

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['shipping_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
      <add position="after"><![CDATA[
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['shipping_address']['district'] = '';
        }
        //---
      ]]>
      </add>
    </operation>
  </file>

  <file path="catalog/controller/checkout/shipping_method.php">
    <operation error="skip">
      <search><![CDATA[$results = $this->model_extension_extension->getExtensions('shipping');]]></search>
      <add position="after"><![CDATA[
        //frd
  			if ($this->config->get('shindo_status')==true) {
  				$results[] = array('code'=>'igstiki');
  				$results[] = array('code'=>'igsjne');
  			}
  			foreach ($results as $key => $result) {
  				if ($result['code']=='shindo') {
  					unset ($results[$key]);
  				}
  			}
  			//----
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/checkout/payment_address.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district'); //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="0"><![CDATA[$this->load->model('localisation/country');]]></search>
      <add position="before"><![CDATA[
        //frd
    		if (isset($this->session->data['payment_address']['district_id'])) {
    			$data['district_id'] =  $this->session->data['payment_address']['district_id'];
    		} else {
    			$data['district_id'] = '';
    		}
    		//------
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($this->request->post['address_id']);]]></search>
      <add position="after"><![CDATA[
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['payment_address']['district'] = '';
        }
        //---
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($address_id);]]></search>
      <add position="after"><![CDATA[
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['payment_address']['district'] = '';
        }
        //---

      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/checkout/shipping_address.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district');//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="0"><![CDATA[$this->load->model('localisation/country');]]></search>
      <add position="before"><![CDATA[
        //frd
    		if (isset($this->session->data['shipping_address']['district_id'])) {
    			$data['district_id'] =  $this->session->data['shipping_address']['district_id'];
    		} else {
    			$data['district_id'] = '';
    		}
    		//------
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['shipping_address'] = $this->model_account_address->getAddress($this->request->post['address_id']);]]></search>
      <add position="after"><![CDATA[
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['shipping_address']['district'] = '';
        }
        //---

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['shipping_address'] = $this->model_account_address->getAddress($address_id);]]></search>
      <add position="after"><![CDATA[
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['shipping_address']['district'] = '';
        }
        //---
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/checkout/guest.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district');//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="0"><![CDATA[$this->load->model('localisation/country');]]></search>
      <add position="before"><![CDATA[
        //frd
    		if (isset($this->session->data['payment_address']['district_id'])) {
    			$data['district_id'] = $this->session->data['payment_address']['district_id'];
    		} elseif (isset($this->session->data['shipping_address']['district_id'])) {
    			$data['district_id'] = $this->session->data['shipping_address']['district_id'];
    		} else {
    			$data['district_id'] = '';
    		}
    		//-------

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[// Customer Group]]></search>
      <add position="before"><![CDATA[
        //frd
  			if (!isset($this->request->post['district_id']) || $this->request->post['district_id'] == '' || !is_numeric($this->request->post['district_id'])) {
  				$json['error']['district'] = $this->language->get('error_district');
  			}
  			//------
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address']['zone_id'] = $this->request->post['zone_id'];]]></search>
      <add position="after"><![CDATA[
        //frd
  			$this->session->data['payment_address']['district_id'] = $this->request->post['district_id'];
  			//----
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[if (!empty($this->request->post['shipping_address'])) {]]></search>
      <add position="before"><![CDATA[
        //frd
  			$this->load->model('localisation/district');
  			$district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
  			if (isset($district['rajaongkir']['results']['city_name'])){
  				$this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
  			} else {
  				$this->session->data['payment_address']['district'] = '';
  			}
  			//---

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['shipping_address']['zone_id'] = $this->request->post['zone_id'];]]></search>
      <add position="after"><![CDATA[
        //frd
				$this->session->data['shipping_address']['district_id'] = $this->request->post['district_id'];
				//---
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="1"><![CDATA[if (isset($this->request->post['custom_field']['address'])) {]]></search>
      <add position="before"><![CDATA[
        //frd
				$this->load->model('localisation/district');
				$district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
				if (isset($district['rajaongkir']['results']['city_name'])){
					$this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
				} else {
					$this->session->data['shipping_address']['district'] = '';
				}
				//---
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/checkout/guest_shipping.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district');//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="0"><![CDATA[$this->load->model('localisation/country');]]></search>
      <add position="before"><![CDATA[
        //frd
    		if (isset($this->session->data['shipping_address']['district_id'])) {
    			$data['district_id'] = $this->session->data['shipping_address']['district_id'];
    		} else {
    			$data['district_id'] = '';
    		}
    		//---

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[// Custom field validation]]></search>
      <add position="before"><![CDATA[
        //frd
  			if (!isset($this->request->post['district_id']) || $this->request->post['district_id'] == '' || !is_numeric($this->request->post['district_id'])) {
  				$json['error']['district'] = $this->language->get('error_district');
  			}
  			//---
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['shipping_address']['zone_id'] = $this->request->post['zone_id'];]]></search>
      <add position="after"><![CDATA[
        $this->session->data['shipping_address']['district_id'] = $this->request->post['district_id'];//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[if (isset($this->request->post['custom_field'])) {]]></search>
      <add position="before"><![CDATA[
        //frd
  			$this->load->model('localisation/district');
  			$district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
  			if (isset($district['rajaongkir']['results']['city_name'])){
  				$this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
  			} else {
  				$this->session->data['shipping_address']['district'] = '';
  			}
  			//---

      ]]>
      </add>
    </operation>

  </file>
  <file path="catalog/controller/checkout/confirm.php">
    <operation error="skip">
      <search><![CDATA[$order_data['payment_zone_id'] = $this->session->data['payment_address']['zone_id'];]]></search>
      <add position="after"><![CDATA[
        $order_data['payment_district'] = $this->session->data['payment_address']['district'];//frd
  			$order_data['payment_district_id'] = $this->session->data['payment_address']['district_id'];//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$order_data['shipping_zone_id'] = $this->session->data['shipping_address']['zone_id'];]]></search>
      <add position="after"><![CDATA[
        $order_data['shipping_district'] = $this->session->data['shipping_address']['district'];//frd
				$order_data['shipping_district_id'] = $this->session->data['shipping_address']['district_id'];//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$order_data['shipping_zone_id'] = '';]]></search>
      <add position="after"><![CDATA[
        $order_data['shipping_district'] = '';//frd
				$order_data['shipping_district_id'] = '';//frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/checkout/login.php">
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
      <add position="after"><![CDATA[
        //frd
				$this->load->model('localisation/district');
				$district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
				if (isset($district['rajaongkir']['results']['city_name'])){
					$this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
				} else {
					$this->session->data['shipping_address']['district'] = '';
				}
				//---
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
      <add position="after"><![CDATA[
        //frd
				$this->load->model('localisation/district');
				$district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
				if (isset($district['rajaongkir']['results']['city_name'])){
					$this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
				} else {
					$this->session->data['payment_address']['district'] = '';
				}
				//---

      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/checkout/register.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district'); //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
      <add position="after"><![CDATA[
        //frd
				$this->load->model('localisation/district');
				$district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
				if (isset($district['rajaongkir']['results']['city_name'])){
					$this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
				} else {
					$this->session->data['payment_address']['district'] = '';
				}
				//---
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->session->data['shipping_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
      <add position="after"><![CDATA[
        $this->session->data['shipping_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['shipping_address']['district'] = '';
        }
        //---
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/extension/total/shipping.php">
    <operation error="skip">
      <search><![CDATA[$data['entry_zone'] = $this->language->get('entry_zone');]]></search>
      <add position="after"><![CDATA[
        $data['entry_district'] = $this->language->get('entry_district');//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[if (isset($this->session->data['shipping_address']['postcode'])) {]]></search>
      <add position="before"><![CDATA[
        //frd
  			if (isset($this->session->data['shipping_address']['district_id'])) {
  				$data['district_id'] =  $this->session->data['shipping_address']['district_id'];
  			} else {
  				$data['district_id'] = '';
  			}
  			//------

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$this->request->post['zone_id'],]]></search>
      <add position="after"><![CDATA[
        'district_id'    => $this->request->post['district_id'],//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$quote_data = array();]]></search>
      <add position="before"><![CDATA[
        //frd
  			$this->load->model('localisation/district');
  			$district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
  			if (isset($district['rajaongkir']['results']['city_name'])){
  				$this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
  			} else {
  				$this->session->data['shipping_address']['district'] = '';
  			}
  			//---

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$results = $this->model_extension_extension->getExtensions('shipping');]]></search>
      <add position="after"><![CDATA[
        //frd
  			if ($this->config->get('shindo_status')==true) {
  				$results[] = array('code'=>'igstiki');
  				$results[] = array('code'=>'igsjne');
  			}
  			foreach ($results as $key => $result) {
  				if ($result['code']=='shindo') {
  					unset ($results[$key]);
  				}
  			}
  			//----

      ]]>
      </add>
    </operation>

  </file>
  <file path="catalog/controller/api/order.php">
    <operation error="skip">
      <search><![CDATA[$order_data['payment_zone_id'] = $this->session->data['payment_address']['zone_id'];]]></search>
      <add position="after"><![CDATA[
        $order_data['payment_district'] = $this->session->data['payment_address']['district'];//frd
				$order_data['payment_district_id'] = $this->session->data['payment_address']['district_id'];//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$order_data['shipping_zone_id'] = $this->session->data['shipping_address']['zone_id'];]]></search>
      <add position="after"><![CDATA[
        $order_data['shipping_district'] = $this->session->data['shipping_address']['district'];//frd
        $order_data['shipping_district_id'] = $this->session->data['shipping_address']['district_id'];//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$order_data['shipping_zone_id'] = '';]]></search>
      <add position="after"><![CDATA[
        $order_data['shipping_district'] = '';//frd
        $order_data['shipping_district_id'] = '';//frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/api/payment.php">
    <operation error="skip">
      <search><![CDATA[$zone,]]></search>
      <add position="after"><![CDATA[
        'district_id'    => $this->request->post['district_id'], //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$json['success'] = $this->language->get('text_address');]]></search>
      <add position="before"><![CDATA[
        //frd
				$this->load->model('localisation/district');
				$district = $this->model_localisation_district->getDistrict($this->session->data['payment_address']['district_id']);
				if (isset($district['rajaongkir']['results']['city_name'])){
					$this->session->data['payment_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
				} else {
					$this->session->data['payment_address']['district'] = '';
				}
				//---

      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/api/shipping.php">
    <operation error="skip">
      <search><![CDATA[$zone,]]></search>
      <add position="after"><![CDATA[
        'district_id'    => $this->request->post['district_id'],//frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$json['success'] = $this->language->get('text_address');]]></search>
      <add position="before"><![CDATA[
        //frd
        $this->load->model('localisation/district');
        $district = $this->model_localisation_district->getDistrict($this->session->data['shipping_address']['district_id']);
        if (isset($district['rajaongkir']['results']['city_name'])){
          $this->session->data['shipping_address']['district'] = $district['rajaongkir']['results']['city_name'] . ' - ' . $district['rajaongkir']['results']['type'];
        } else {
          $this->session->data['shipping_address']['district'] = '';
        }
        //---

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$results = $this->model_extension_extension->getExtensions('shipping');]]></search>
      <add position="after"><![CDATA[
        //frd
        if ($this->config->get('shindo_status')==true) {
  				$results[] = array('code'=>'igstiki');
  				$results[] = array('code'=>'igsjne');
        }
				foreach ($results as $key => $result) {
					if ($result['code']=='shindo') {
						unset ($results[$key]);
					}
				}
				//----
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/model/account/address.php">
    <operation error="skip">
      <search position="replace" trim="true"><![CDATA[$this->db->query("INSERT INTO " . DB_PREFIX . "address SET]]></search>
      <add><![CDATA[/*frd*/$this->db->query("INSERT INTO " . DB_PREFIX . "address SET district_id ='" . (int)$this->db->escape($data['district_id']) . "', ]]>
      </add>
    </operation>
    <operation error="skip">
      <search position="replace" trim="true"><![CDATA[$this->db->query("UPDATE " . DB_PREFIX . "address SET]]></search>
      <add><![CDATA[/*frd*/$this->db->query("UPDATE " . DB_PREFIX . "address SET district_id ='" . (int)$this->db->escape($data['district_id']) . "', ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[json_decode($address_query->row['custom_field'], true)]]></search>
      <add position="after"><![CDATA[
        ,'district_id'     => $address_query->row['district_id'],//frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/model/account/customer.php">
    <operation error="skip">
      <search position="replace" trim="true"><![CDATA[$this->db->query("INSERT INTO " . DB_PREFIX . "address SET]]></search>
      <add><![CDATA[/*frd*/$this->db->query("INSERT INTO " . DB_PREFIX . "address SET district_id ='" . (int)$this->db->escape($data['district_id']) . "', ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/model/checkout/order.php">
    <operation error="skip">
      <search position="replace" trim="true"><![CDATA[$this->db->query("INSERT INTO `" . DB_PREFIX . "order` SET]]></search>
      <add><![CDATA[/*frd*/$this->db->query("INSERT INTO `" . DB_PREFIX . "order` SET payment_district = '" . $this->db->escape($data['payment_district']) . "', payment_district_id = '" .  (int)$data['payment_district_id'] . "', shipping_district = '" . $this->db->escape($data['shipping_district']) . "', shipping_district_id = '" . (int)$data['shipping_district_id'] . "', ]]>
      </add>
    </operation>
    <operation error="skip">
      <search position="replace" trim="true"><![CDATA[$this->db->query("UPDATE `" . DB_PREFIX . "order` SET invoice_prefix = '" . $this->db->escape($data['invoice_prefix']) . "',]]></search>
      <add><![CDATA[/*frd*/$this->db->query("UPDATE `" . DB_PREFIX . "order` SET invoice_prefix = '" . $this->db->escape($data['invoice_prefix']) . "', payment_district = '" . $this->db->escape($data['payment_district']) . "', payment_district_id = '" . (int)$data['payment_district_id'] . "', shipping_district = '" . $this->db->escape($data['shipping_district']) . "', shipping_district_id = '" . (int)$data['shipping_district_id'] . "', ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$order_query->row['payment_zone'],]]></search>
      <add position="after"><![CDATA[
        'payment_district_id'     => $order_query->row['payment_district_id'], //frd
				'payment_district'        => $order_query->row['payment_district'], //frd
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$order_query->row['shipping_zone'],]]></search>
      <add position="after"><![CDATA[
        'shipping_district_id'    => $order_query->row['shipping_district_id'],//frd
				'shipping_district'       => $order_query->row['shipping_district'], //frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/language/en-gb/account/{address,register}.php">
    <operation error="skip">
      <search><![CDATA[$_['entry_zone']]]></search>
      <add position="after"><![CDATA[
        $_['entry_district']           = 'District / City'; //frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/language/en-gb/checkout/checkout.php">
    <operation error="skip">
      <search><![CDATA[$_['entry_zone']]]></search>
      <add position="after"><![CDATA[
        $_['entry_district']           = 'District / City'; //frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/language/en-gb/extension/total/shipping.php">
    <operation error="skip">
      <search><![CDATA[$_['entry_zone']]]></search>
      <add position="after"><![CDATA[
        $_['entry_district']           = 'District / City'; //frd
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/view/theme/default/template/account/address_form.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!--frd-->
        <?php if (!empty($zone_id)) {?>
        <option value="<?php echo $zone_id; ?>"></option>
        <?php } ?>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="col-sm-2 control-label" for="input-district"><?php echo $entry_district; ?></label>
          <div class="col-sm-10">
            <select name="district_id" id="input-district" class="form-control">
            </select>
            <?php if ($error_district) { ?>
            <div class="text-danger"><?php echo $error_district; ?></div>
            <?php } ?>
          </div>
        </div>
        <!------>

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php echo $footer; ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });

        $('select[name=\'zone_id\']').trigger('change');
        //--></script>

      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/view/theme/default/template/account/register.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!---frd-->
        <?php if (!empty($zone_id)) {?>
        <option value="<?php echo $zone_id; ?>"></option>
        <?php } ?>
        <!---frd-->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="col-sm-2 control-label" for="input-district"><?php echo $entry_district; ?></label>
          <div class="col-sm-10">
            <select name="district_id" id="input-district" class="form-control">
            </select>
            <?php if ($error_district) { ?>
            <div class="text-danger"><?php echo $error_district; ?></div>
            <?php } ?>
          </div>
        </div>
        <!------>
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php echo $footer; ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });

        $('select[name=\'zone_id\']').trigger('change');
        //--></script>
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/view/theme/default/template/extension/total/shipping.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!---frd-->
        <?php if (!empty($zone_id)) {?>
        <option value="<?php echo $zone_id; ?>"></option>
        <?php } ?>
        <!---frd-->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<label class="col-sm-2 control-label" for="input-postcode"><?php echo $entry_postcode; ?></label>]]></search>
      <add position="before" offset="1"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="col-sm-2 control-label" for="input-district"><?php echo $entry_district; ?></label>
          <div class="col-sm-10">
            <select name="district_id" id="input-district" class="form-control">
              <?php if (!empty($district_id)) {?>
              <option value="<?php echo $district_id; ?>"></option>
              <?php } ?>
            </select>
            <!--<?php if ($error_district) { ?>
            <div class="text-danger"><?php echo $error_district; ?></div>
            <?php } ?>-->
          </div>
        </div>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[data: 'country_id=' + $('select[name=\'country_id\']').val() + '&zone_id=' + $('select[name=\'zone_id\']').val() + '&postcode=' + encodeURIComponent($('input[name=\'postcode\']').val()),]]></search>
      <add position="replace"><![CDATA[
        /*frd*/
        data: 'country_id=' + $('select[name=\'country_id\']').val() + '&zone_id=' + $('select[name=\'zone_id\']').val() + '&postcode=' + encodeURIComponent($('input[name=\'postcode\']').val()) + '&district_id=' + $('select[name=\'district_id\']').val(),
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[html += json['shipping_method'][i]['quote'][j]['title'] + ' - ' + json['shipping_method'][i]['quote'][j]['text'] + '</label></div>';]]></search>
      <add position="replace"><![CDATA[
        /*frd*/
        if(typeof(json['shipping_method'][i]['quote'][j]['etd']) != "undefined" && json['shipping_method'][i]['quote'][j]['etd'] !== null) {
          html += json['shipping_method'][i]['quote'][j]['title'] + ' - ' + json['shipping_method'][i]['quote'][j]['text'] + '<p style="font-size:85%;">Est: ' + json['shipping_method'][i]['quote'][j]['etd'] + '</p>' + '</label></div>';
        } else {
          html += json['shipping_method'][i]['quote'][j]['title'] + ' - ' + json['shipping_method'][i]['quote'][j]['text'] + '</label></div>';
        }
        /*--*/
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$('select[name=\'country_id\']').trigger('change');]]></search>
      <add position="after" offset="1"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });
        $('select[name=\'zone_id\']').trigger('change');
        //--></script>

      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/view/theme/default/template/checkout/payment_address.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-payment-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!---frd-->
        <?php if (!empty($zone_id)) {?>
        <option value="<?php echo $zone_id; ?>"></option>
        <?php } ?>
        <!---frd-->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="col-sm-2 control-label" for="input-payment-district"><?php echo $entry_district; ?></label>
          <div class="col-sm-10">
            <select name="district_id" id="input-payment-district" class="form-control">
              <?php if (!empty($district_id)) {?>
              <option value="<?php echo $district_id; ?>"></option>
              <?php } ?>

            </select>
            <!--<?php if ($error_district) { ?>
            <div class="text-danger"><?php echo $error_district; ?></div>
            <?php } ?>-->
          </div>
        </div>
      ]]>
      <!---->
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$('#collapse-payment-address select[name=\'country_id\']').trigger('change');]]></search>
      <add position="after" offset="1"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('#collapse-payment-address select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('#collapse-payment-address select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('#collapse-payment-address select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });
        $('#collapse-payment-address select[name=\'zone_id\']').trigger('change');
        //--></script>
      ]]>
      </add>
    </operation>

  </file>
  <file path="catalog/view/theme/default/template/checkout/shipping_address.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-shipping-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!---frd-->
        <?php if (!empty($zone_id)) {?>
        <option value="<?php echo $zone_id; ?>"></option>
        <?php } ?>
        <!---frd-->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="col-sm-2 control-label" for="input-shipping-district"><?php echo $entry_district; ?></label>
          <div class="col-sm-10">
            <select name="district_id" id="input-shipping-district" class="form-control">
              <?php if (!empty($district_id)) {?>
              <option value="<?php echo $district_id; ?>"></option>
              <?php } ?>
            </select>
            <!--<?php if ($error_district) { ?>
            <div class="text-danger"><?php echo $error_district; ?></div>
            <?php } ?>-->
          </div>
        </div>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$('#collapse-shipping-address select[name=\'country_id\']').trigger('change');]]></search>
      <add position="after" offset="1"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('#collapse-shipping-address select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('#collapse-shipping-address select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('#collapse-shipping-address select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });
        $('#collapse-shipping-address select[name=\'zone_id\']').trigger('change');
        //--></script>

      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/view/theme/default/template/checkout/guest_shipping.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-shipping-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!---frd-->
        <?php if (!empty($zone_id)) {?>
        <option value="<?php echo $zone_id; ?>"></option>
        <?php } ?>
        <!---frd-->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="col-sm-2 control-label" for="input-shipping-district"><?php echo $entry_district; ?></label>
          <div class="col-sm-10">
            <select name="district_id" id="input-shipping-district" class="form-control">
            </select>
            <!--<?php if ($error_district) { ?>
            <div class="text-danger"><?php echo $error_district; ?></div>
            <?php } ?>-->
          </div>
        </div>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$('#collapse-shipping-address select[name=\'country_id\']').trigger('change');]]></search>
      <add position="after" offset="1"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('#collapse-shipping-address select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('#collapse-shipping-address select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('#collapse-shipping-address select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });

        $('#collapse-shipping-address select[name=\'zone_id\']').trigger('change');
        //--></script>
      ]]>
      </add>
    </operation>

  </file>
  <file path="catalog/view/theme/default/template/checkout/guest.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-payment-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
        <!---frd-->
        <?php if (!empty($zone_id)) {?>
        <option value="<?php echo $zone_id; ?>"></option>
        <?php } ?>
        <!---frd-->

      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="control-label" for="input-payment-zone"><?php echo $entry_district; ?></label>
          <select name="district_id" id="input-payment-district" class="form-control">
          </select>
          <!--<?php if ($error_district) { ?>
          <div class="text-danger"><?php echo $error_district; ?></div>
            <?php } ?>-->
        </div>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$('#collapse-payment-address select[name=\'country_id\']').trigger('change');]]></search>
      <add position="after" offset="1"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('#collapse-payment-address select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('#collapse-payment-address select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('#collapse-payment-address select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });

        $('#collapse-payment-address select[name=\'zone_id\']').trigger('change');
        //--></script>
        ]]>
      </add>
    </operation>

  </file>
  <file path="catalog/view/theme/default/template/checkout/shipping_method.tpl">
    <operation error="skip">
      <search><![CDATA[<?php echo $quote['title']; ?> - <?php echo $quote['text']; ?></label>]]></search>
      <add position="replace"><![CDATA[
        <!--frd-->
        <?php echo $quote['title']; ?> - <?php echo $quote['text']; ?><p style="font-size:85%;"><?php echo isset($quote['etd']) ?  'Est: ' . $quote['etd'] : ''; ?></p></label>
        <!---->
      ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/view/theme/default/template/checkout/register.tpl">
    <operation error="skip">
      <search><![CDATA[<select name="zone_id" id="input-payment-zone" class="form-control">]]></search>
      <add position="after"><![CDATA[
          <!---frd-->
          <?php if (!empty($zone_id)) {?>
          <option value="<?php echo $zone_id; ?>"></option>
          <?php } ?>
          <!---frd-->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search index="1"><![CDATA[<?php foreach ($custom_fields as $custom_field) { ?>]]></search>
      <add position="before"><![CDATA[
        <!--frd-->
        <div class="form-group required">
          <label class="control-label" for="input-payment-district"><?php echo $entry_district; ?></label>
          <select name="district_id" id="input-payment-district" class="form-control">
          </select>
        </div>
        <!---->
      ]]>
      </add>
    </operation>
    <operation error="skip">
      <search><![CDATA[$('#collapse-payment-address select[name=\'country_id\']').trigger('change');]]></search>
      <add position="after" offset="1"><![CDATA[
        <!--frd-->
        <script type="text/javascript"><!--
        $('#collapse-payment-address select[name=\'zone_id\']').on('change', function() {
        	$.ajax({
        		url: 'index.php?route=account/account/zone&zone_id=' + this.value,
        		dataType: 'json',
        		beforeSend: function() {
        			$('#collapse-payment-address select[name=\'zone_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
        		},
        		complete: function() {
        			$('.fa-spin').remove();
        		},
        		success: function(json) {

              html = '<option value=""><?php echo $text_select; ?></option>';

        			if (json['raoprop'] && json['raoprop']['rajaongkir']['results'] != '') {

        				for (i = 0; i < json['raoprop']['rajaongkir']['results'].length; i++) {
        					html += '<option value="' + json['raoprop']['rajaongkir']['results'][i]['city_id'] + '"';

        					if (json['raoprop']['rajaongkir']['results'][i]['city_id'] == '<?php echo $district_id; ?>') {
        						html += ' selected="selected"';
                  }

        			  		html += '>' + json['raoprop']['rajaongkir']['results'][i]['city_name'] + ' - ' + json['raoprop']['rajaongkir']['results'][i]['type'] + '</option>';
        				}
        			} else {
        				/*html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';*/
        			}

        			$('#collapse-payment-address select[name=\'district_id\']').html(html);
        		},
        		error: function(xhr, ajaxOptions, thrownError) {
        			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        		}
        	});
        });
        $('#collapse-payment-address select[name=\'zone_id\']').trigger('change');
        //--></script>
      ]]>
      </add>
    </operation>
  </file>

</modification>
